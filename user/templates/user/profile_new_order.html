{% extends "base/base.html" %}
{% load crispy_forms_tags %}

{% block content %}

<div class="text-right mb-2 mt-4">
  {% if request.session.my_order.total_payments != 0.0 %}
  <button 
    class="btn btn-primary" 
    onclick="document.getElementById('form').submit();">
    <i class="fas fa-money-bill-wave-alt"></i> 
    Pay now
  </button>
  {% endif %}
  <a type="button" 
    class="btn btn-light mr-3"
    href="{% url 'user_payments' %}">
    <i class="fas fa-chevron-left "></i> 
    Go back
  </a>
</div>

{% include "user/elements/header.html" %}

{% if request.session.my_order.person %}
<article class="media content-section">
  <div class="media-body">
    <div class="row">
      <div class="col-sm-6">
        <h5>Payments</h5>
      </div>
      <div class="col-sm-6">
        <a type="button" 
          class="btn btn-light btn-sm text-info float-right" 
          href="{% url 'user_add_payment' %}">
          <i class="fas fa-plus "></i> 
          Add
        </a>
      </div>
    </div>

    {% if request.session.my_order.payments %}

    {% for object in request.session.my_order.payments %}
    {% include "treasury/elements/payment.html" %}
    {% endfor %}

    <table class="table table-hover table-sm mt-2">
      <tr>
        <th class="text-right">TOTAL:</th>
        <th class="text-right" id="totPayment" width="10%">
          {{ request.session.my_order.total_payments|floatformat:2 }}
        </th>
        <th width="28px"></th>
      </tr>
    </table>

    {% endif %}
  </div>
</article>
{% endif %}

{% if request.session.my_order.payments %}
{% include 'user/elements/profile_payment_form.html' %}
{% endif %}

{% endblock %}

{% block scripts %}
<script>
  var form = new Vue({
    el: '#form',
    data: {
      seen: true,
      selected: 'PIX',
    },
    methods: {
      viewPix: function () {
        this.seen = this.selected != "PIX" ? false : true
      }
    }
  })
</script>
{% endblock %}